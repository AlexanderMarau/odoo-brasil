<?xml version="1.0" encoding="utf-8"?>
<openerp>
	<data>

		<record id="l10n_br_account_product_invoice_form" model="ir.ui.view">
			<field name="name">l10n_br_account_product.invoice.form</field>
			<field name="model">account.invoice</field>
			<field name="inherit_id" ref="account.invoice_form"/>
			<field name="arch" type="xml">
        		<field name="date_invoice" position="after">
					<field name="date_hour_invoice" string="Data Emissão"/>
					<field name="fiscal_document_electronic" invisible="1"/>
				</field>
        		<field name="date_invoice" position="replace">
					<field name="date_invoice" invisible="1"/>
				</field>
				<notebook position="inside">
					<page string="Dados Adicionais">
						<notebook>
							<page string="Transporte">
								<group name="delivery_info">
									<field name="carrier_name"/>
									<field name="vehicle_plate"/>
									<field name="vehicle_state_id"/>
									<field name="vehicle_city_id"/>
									<field name="amount_freight"/>
									<field name="amount_insurance"/>
									<field name="amount_costs"/>
                                    <field name="amount_total_taxes"/>
								</group>
								<group name="package_info">
									<field name="weight"/>
									<field name="weight_net"/>
									<field name="number_of_packages"/>
									<field name="kind_of_packages"/>
									<field name="brand_of_packages"/>
									<field name="notation_of_packages"/>
								</group>
							</page>
						</notebook>
					</page>
					<page string="Observações">
						<group string="Observações">
							<field name="comment" nolabel="1"/>
						</group>
						<group string="Observações Fiscais">
							<field name="fiscal_comment" nolabel="1"/>
						</group>
					</page>
				</notebook>
				<field name="amount_untaxed" position="before">
					<field name="amount_gross"  widget='monetary' options="{'currency_field': 'currency_id'}"/>
					<field name="amount_discount" widget='monetary' options="{'currency_field': 'currency_id'}"/>
				</field>
                <xpath expr="//field[@name='fiscal_position_id']" position="after">
                    <field name="ind_final" string="Operação com Consumidor final" />
                    <field name="ind_pres" string="Tipo de operação" />
                </xpath>
			</field>
		</record>

		<!-- Vendor view -->
		<record id="l10n_br_account_product_invoice_supplier_form" model="ir.ui.view">
			<field name="name">l10n_br_account.invoice.supplier.form</field>
			<field name="model">account.invoice</field>
			<field name="inherit_id" ref="account.invoice_supplier_form" />
			<field name="arch" type="xml">
				<field name="date_invoice" position="after">
					<field name="document_serie_id" />
					<field name="fiscal_document_id" required="1"/>
					<field name="date_hour_invoice" string="Data Emissão"/>
					<field name="fiscal_document_electronic" invisible="1"/>
				</field>
				<field name="date_invoice" position="attributes">
					<field name="date_invoice" invisible="1"/>
				</field>
				<notebook>
					<page string="Dados Adicionais">
						<notebook>
							<page string="Transporte">
								<group name="delivery_info">
									<field name="carrier_name"/>
									<field name="vehicle_plate"/>
									<field name="vehicle_state_id"/>
									<field name="vehicle_city_id"/>
									<field name="amount_freight"/>
									<field name="amount_insurance"/>
									<field name="amount_costs"/>
									<field name="amount_total_taxes"/>
								</group>
								<group name="package_info">
									<field name="weight"/>
									<field name="weight_net"/>
									<field name="number_of_packages"/>
									<field name="kind_of_packages"/>
									<field name="brand_of_packages"/>
									<field name="notation_of_packages"/>
								</group>
							</page>
						</notebook>
					</page>
                    <page string="Observações">
                        <group string="Observações">
                            <field name="comment" nolabel="1"/>
                        </group>
                        <group string="Observações Fiscais">
                            <field name="fiscal_comment" nolabel="1"/>
                        </group>
                    </page>
				</notebook>
			</field>
		</record>

		<!-- Invoice Line views -->
		<record model="ir.ui.view" id="l10n_br_account_product_invoice_line_tree">
			<field name="name">l10n_br_account_product.invoice.line.tree</field>
			<field name="model">account.invoice.line</field>
			<field name="inherit_id" ref="account.view_invoice_line_tree" />
			<field name="priority">26</field>
			<field name="arch" type="xml">
				<field name="account_id" position="replace">
					<field name="cfop_id" />
				</field>
			</field>
		</record>

		<record model="ir.ui.view" id="view_l10n_br_account_invoice_line_form">
			<field name="name">l10n_br_account.invoice.line.form</field>
			<field name="model">account.invoice.line</field>
			<field name="inherit_id" ref="account.view_invoice_line_form" />
			<field name="priority">36</field>
			<field name="arch" type="xml">
			 	<form position="replace">
				 	<form string="Invoice Line">
					 	<notebook>
							<page string="Geral">
								<group>
									<group>
										<field name="product_id" />
                                        <field name="product_type" invisible="1"/>
										<label for="quantity"/>
										<div>
											<field name="quantity" class="oe_inline"/>
										</div>
										<field name="price_unit"/>
										<field name="discount" groups="sale.group_discount_per_so_line"/>
										<field name="freight_value" />
										<field name="insurance_value" />
										<field name="other_costs_value" />
										<field name="total_taxes"/>
									</group>
									<group>
										<field name="fiscal_position_id" required="1"/>
										<field name="cfop_id"/>
										<field domain="[('journal_id', '=', parent.journal_id), ('type', '&lt;&gt;', 'view')]" name="account_id" groups="account.group_account_user"/>
										<field domain="[('type','&lt;&gt;','view'), ('company_id', '=', parent.company_id)]" name="account_analytic_id" groups="analytic.group_analytic_accounting"/>
										<field name="company_id" groups="base.group_multi_company" readonly="1"/>
										<field name="invoice_line_tax_ids" widget="many2many_tags" />
									</group>
								</group>
								<label for="name"/>
								<field name="name"/>
							</page>
							<page name="icms" string="ICMS" attrs="{'invisible': [('product_type', '=', 'service')]}">
								<group name="detalhes_icms" string="Detalhes do ICMS">
									<group>
										<field name="icms_manual" invisible="True"/>
                                        <field name="tax_icms_id" />
										<field name="icms_cst" attrs="{'required': [('product_type','=', 'product')]}"/>
										<field name="icms_origin"/>
										<field name="icms_base_type"/>
										<field name="icms_base"/>
										<field name="icms_percent_reduction"/>
                                        <field name="icms_percent_credit" />
                                        <field name="icms_value_credit" />
									</group>
									<group>
										<field name="icms_base_other"/>
										<field name="icms_percent"/>
										<field name="icms_value"/>
									</group>
								</group>
								<group name="substituicao_icms" string="Substituição Tributária ICMS">
									<group>
										<field name="icms_st_base_type"/>
										<field name="icms_st_base"/>
										<field name="icms_st_percent_reduction"/>
										<field name="icms_st_base_other"/>
									</group>
									<group>
										<field name="icms_st_percent"/>
										<field name="icms_st_mva"/>
										<field name="icms_st_value"/>
									</group>
								</group>
							</page>
							<page name="issqn" string="ISSQN" attrs="{'invisible': [('product_type','!=', 'service')]}">
								<group>
									<field name="tax_issqn_id" />
									<field name="issqn_manual" invisible="True"/>
									<field name="issqn_type"/>
									<field name="issqn_base"/>
									<field name="issqn_percent"/>
									<field name="service_type_id" attrs="{'required': [('product_type','=', 'service')]}" domain="[('internal_type','=','normal')]"/>
									<field name="issqn_value"/>
								</group>
							</page>
							<page name="ipi" string="IPI" attrs="{'invisible': [('product_type','=', 'service')]}">
								<group string="Detalhes do IPI">
									<group>
										<field name="tax_ipi_id" />
										<field name="ipi_manual" invisible="True"/>
										<field name="ipi_cst" attrs="{'required': [('product_type','=', 'product')]}"/>
										<field name="ipi_type"/>
										<field name="ipi_base"/>
									</group>
									<group>
										<field name="ipi_base_other"/>
										<field name="ipi_percent"/>
										<field name="ipi_value"/>
									</group>
								</group>
							</page>
							<page name="pis" string="PIS">
								<group string="Detalhes do PIS">
									<group>
										<field name="tax_pis_id" />
										<field name="pis_manual" invisible="True"/>
										<field name="pis_cst" attrs="{'required': [('product_type','in', ('product', 'service'))]}"/>
										<field name="pis_type"/>
										<field name="pis_base"/>
									</group>
									<group>
										<field name="pis_percent"/>
										<field name="pis_value"/>
									</group>
								</group>
								<group string="Detalhes do PIS ST">
									<group>
										<field name="pis_st_type"/>
										<field name="pis_st_base"/>
									</group>
									<group>
										<field name="pis_st_percent"/>
										<field name="pis_st_value"/>
									</group>
								</group>
							</page>
							<page name="cofins" string="COFINS">
								<group string="Detalhes do COFINS">
									<group>
										<field name="tax_cofins_id" />
										<field name="cofins_manual" invisible="True"/>
										<field name="cofins_cst" attrs="{'required': [('product_type','in', ('product', 'service'))]}"/>
										<field name="cofins_type"/>
										<field name="cofins_base"/>
									</group>
									<group>
										<field name="cofins_percent"/>
										<field name="cofins_value"/>
									</group>
								</group>
								<group string="Detalhes do COFINS ST">
									<group>
										<field name="cofins_st_type"/>
										<field name="cofins_st_base"/>
									</group>
									<group>
										<field name="cofins_st_percent"/>
										<field name="cofins_st_value"/>
									</group>
								</group>
							</page>
							<page name="ii" string="II" attrs="{'invisible': [('product_type','=', 'service')]}">
								<group string="Detalhes do Imposto de Importação">
									<field name="tax_ii_id" />
									<field name="ii_base"/>
									<field name="ii_customhouse_charges"/>
									<field name="ii_iof"/>
									<field name="ii_value"/>
								</group>
							</page>
							<page name="di" string="DI">
								<group>
								</group>
							</page>
						</notebook>
					</form>
				</form>
			</field>
		</record>

		<record id="account.action_invoice_tree" model="ir.actions.act_window">
			<field name="domain">[('type', '=', 'out_invoice'), ('fiscal_type', '=', 'product')]</field>
		</record>

		<record id="account.action_invoice_tree1" model="ir.actions.act_window">
			<field name="domain">[('type', '=', 'out_invoice'), ('fiscal_type', '=', 'product')]</field>
		</record>

		<record id="account.action_invoice_tree2" model="ir.actions.act_window">
			<field name="domain">[('type', '=', 'in_invoice'), ('fiscal_type', '=', 'product')]</field>
		</record>

		<record id="account.action_invoice_tree_pending_invoice" model="ir.actions.act_window">
			<field name="domain">[('type', '=', 'out_invoice'), ('fiscal_type', '=', 'product')]</field>
		</record>

	</data>

</openerp>
